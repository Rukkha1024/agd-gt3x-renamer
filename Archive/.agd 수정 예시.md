# How to Analyze and Modify ActiGraph *.agd Files

## Structure of *.agd Files

*   The ActiGraph **AGD** file is the **default storage format** for **ActiLife software**. According to Appendix A of the ActiLife 5 User's Manual, AGD files are stored in an *SQLite* database format and are automatically generated when downloading data from devices other than the GT3X+ [[1]](https://dl.theactigraph.com/actilife5-pub10doc10-h.pdf#:~:text=understand%20how%20the%20data%20on,A%20of%20this%20users%20guide). Therefore, this file is not a text file but an SQLite database, and you can use standard SQLite tools to view the table structure or modify data.

*   The AGD data table described in Appendix A consists of columns such as dataTimeStamp, axis1, axis2, axis3, steps, lux, and inclineOff/Standing/Sitting/Lying [[2]](https://dl.theactigraph.com/actilife5-pub10doc10-h.pdf).

*   The **dataTimeStamp** value is stored in the Windows DateTime.Ticks format. One tick corresponds to 100 nanoseconds ($10^{-7}$ seconds) and represents the number of ticks elapsed since 0001-01-01 00:00:00 [[2]](https://dl.theactigraph.com/actilife5-pub10doc10-h.pdf).

*   The **axis1/axis2/axis3** values are accumulated values of selected (post-filtered) activity counts per epoch (e.g., 1 second, 60 seconds) [[2]](https://dl.theactigraph.com/actilife5-pub10doc10-h.pdf).

*   The **steps**, **lux**, and **incline*** columns exist optionally, storing step counts, light intensity, and inclination information depending on the device settings [[2]](https://dl.theactigraph.com/actilife5-pub10doc10-h.pdf).

*   The `settings` table contains metadata such as software version, device model, epoch length, start/stop times, and wearer information (sex, height, weight, etc.) stored as strings. You can find and modify fields like `subjectname`, `sex`, `height`, `mass`, `startdatetime`, and `stopdatetime` in this table.

## Analysis Method Using Python

Since the AGD file is an SQLite database, you can easily load the data using standard Python libraries like `sqlite3` or `pandas`. The code below demonstrates the process of analyzing data using the uploaded file `AB57012901_SongGilbok (2025-03-08)60sec.agd` as an example.

```python
import sqlite3
import datetime
import pandas as pd

# Connect to database
path = '/home/oai/share/AB57012901_SongGilbok (2025-03-08)60sec.agd'
conn = sqlite3.connect(path)

# Check columns in data tables
tables = conn.execute("SELECT name FROM sqlite_master WHERE type='table'").fetchall()
print('List of tables:', tables)
print(conn.execute("PRAGMA table_info(data)").fetchall())

# Query metadata (settings)
dict_settings = dict(conn.execute("SELECT settingName, settingValue FROM settings").fetchall())
print('Measurement Start Time (Ticks):', dict_settings['startdatetime'])

# Function to convert ticks to datetime
base = datetime.datetime(1, 1, 1)
def ticks_to_datetime(ticks):
    return base + datetime.timedelta(microseconds=int(ticks)/10)

start_dt = ticks_to_datetime(int(dict_settings['startdatetime']))
stop_dt  = ticks_to_datetime(int(dict_settings['stopdatetime']))
print('Measurement Period:', start_dt, '→', stop_dt)

# Load data table
raw_df = pd.read_sql_query('SELECT dataTimestamp, axis1, axis2, axis3, steps FROM data', conn)

# Convert timestamp to pandas datetime
raw_df['datetime'] = raw_df['dataTimestamp'].apply(lambda t: ticks_to_datetime(t))

# Convert to Asia/Seoul (+9 hours) if necessary
offset = datetime.timedelta(hours=9)
raw_df['datetime_local'] = raw_df['datetime'] + offset

# Calculate daily activity sums
raw_df['date'] = raw_df['datetime_local'].dt.date
summary = raw_df.groupby('date').agg({'axis1':'sum', 'axis2':'sum', 'axis3':'sum', 'steps':'sum'})
print(summary)
conn.close()
```

The code above provides the following information:

*   The data table (`data`) contains 20,875 epoch rows, and the epoch length is 60 seconds. The `epochlength` value in the `settings` table is also recorded as 60.

*   Converting `startdatetime` and `stopdatetime` from ticks to datetime confirms the data was measured between **2025-03-04 00:00:00 and 2025-03-18 11:55:01**.

*   The daily aggregated activity counts (Axis 1, 2, 3) and step counts (based on Asia/Seoul time) are as follows:

| Date | Axis1 Sum | Axis2 Sum | Axis3 Sum | Steps |
| :--- | :--- | :--- | :--- | :--- |
| 2025‑03‑04 | 51,656 | 76,803 | 43,468 | 2,438 |
| 2025‑03‑05 | 6,907 | 8,946 | 9,545 | 43 |
| 2025‑03‑06 | 7,473 | 8,868 | 7,969 | 41 |
| 2025‑03‑07 | 30,164 | 34,762 | 29,159 | 547 |
| 2025‑03‑08 | 83,966 | 160,193 | 220,335 | 2,810 |
| 2025‑03‑09 | 243,535 | 347,730 | 388,182 | 8,677 |
| 2025‑03‑10 | 73,911 | 176,689 | 177,942 | 2,173 |
| 2025‑03‑11 | 37,075 | 82,322 | 90,278 | 909 |
| 2025‑03‑12 | 185,743 | 288,012 | 195,258 | 6,177 |
| 2025‑03‑13 | 82,941 | 234,491 | 234,307 | 2,106 |
| 2025‑03‑14 | 64,696 | 169,716 | 169,629 | 1,554 |
| 2025‑03‑15 | 105,307 | 160,014 | 178,100 | 3,464 |
| 2025‑03‑16 | 14 | 8 | 0 | 1 |
| 2025‑03‑17 | 0 | 0 | 0 | 0 |
| 2025‑03‑18 | 54,775 | 37,126 | 31,112 | 1,684 |

Daily totals are useful for roughly understanding the activity level of each day. Additionally, you can perform further analysis such as time-series plotting, calculating hourly averages, or vector magnitude using pandas.

## How to Modify AGD Files (Without ActiLife)

Since an AGD file is an SQLite database, **you can modify metadata or data values using the `sqlite3` module.** However, ActiLife strictly expects specific file structures and columns, so changing the structure or adding/deleting data columns may corrupt the file. **It is recommended to back up the original file and modify a separate copy.**

The following is an example of modifying the `subjectname` in the `settings` table. It creates a new file, changes the subject name, and saves it.

```python
import sqlite3, shutil

old_path = '/home/oai/share/AB57012901_SongGilbok (2025-03-08)60sec.agd'
new_path = '/home/oai/share/AB57012901_modified.agd'

# Create a copy after backing up original (implicitly handled by copy)
shutil.copy(old_path, new_path)

# Open database and modify
conn = sqlite3.connect(new_path)
c = conn.cursor()

# Modify subjectname (e.g., HB17_08 → ModifiedName)
c.execute("UPDATE settings SET settingValue=? WHERE settingName='subjectname'", ('ModifiedName',))
conn.commit()
conn.close()
```

After modification, check the `settings` table using `sqlite3` or ActiLife to verify that the change has been applied. You can update other metadata such as `height`, `mass`, `sex` in the same way. **While you can directly modify the data table (`data`), you must be cautious as changes to sensor data can significantly impact research results.**

## Other Tools and Notes

*   R language users can analyze ActiGraph data (AGD, GT3X+) using open-source packages like `activAnalyzer` (CRAN) or `agcounts`. These packages read files into standard data frames and calculate activity metrics (e.g., counts per minute, classification into Sedentary / Light / Moderate / Vigorous).

*   The ActiLife manual explains that AGD files can be exported to CSV or DAT [[1]](https://dl.theactigraph.com/actilife5-pub10doc10-h.pdf#:~:text=understand%20how%20the%20data%20on,A%20of%20this%20users%20guide). However, this conversion usually requires ActiLife software or an AGD viewer. Using Python to save SQLite data via `pandas.DataFrame.to_csv()` achieves a similar effect.

*   Incorrectly changing the AGD file structure or metadata may make the file unreadable in ActiLife or other tools. Therefore, always keep the original and verify that the file opens normally in analysis tools after modification.

## Summary

*   ActiGraph's **AGD** file is in **SQLite database** format, and the ActiLife manual explicitly states that AGD files are compatible with SQLite [[1]](https://dl.theactigraph.com/actilife5-pub10doc10-h.pdf#:~:text=understand%20how%20the%20data%20on,A%20of%20this%20users%20guide). The data table contains columns such as dataTimeStamp, axis1, axis2, axis3, steps, lux, and incline* [[2]](https://dl.theactigraph.com/actilife5-pub10doc10-h.pdf).

*   You can use Python's `sqlite3` and `pandas` to open AGD files, view data and metadata, and calculate basic statistics such as epoch length, measurement period, and daily activity. Data timestamps are in ticks (100 ns units) and need to be converted using the `datetime` module.

*   It is possible to modify an AGD file while maintaining its structure, such as updating string values like `subjectname` in the `settings` table. However, it is crucial to back up the original file and verify that the file opens normally in tools after modification.

This report analyzed the uploaded AGD file to summarize the measurement period and daily activity, and presented a method for modifying AGD files using Python. Users can perform additional analysis or change necessary metadata based on the reported code examples.

---

[[1]](https://dl.theactigraph.com/actilife5-pub10doc10-h.pdf#:~:text=understand%20how%20the%20data%20on,A%20of%20this%20users%20guide) [[2]](https://dl.theactigraph.com/actilife5-pub10doc10-h.pdf) dl.theactigraph.com
